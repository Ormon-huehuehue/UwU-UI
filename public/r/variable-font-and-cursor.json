{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "variable-font-and-cursor",
  "type": "registry:ui",
  "dependencies": [
    "motion"
  ],
  "author": "daniel petho <https://www.danielpetho.com>",
  "registryDependencies": [
    "https://uwuui.com/r/utils.json",
    "https://uwuui.com/r/use-mouse-position-ref.json"
  ],
  "files": [
    {
      "path": "fancy/text/variable-font-and-cursor.tsx",
      "content": "\"use client\"\n\nimport React, { ElementType, useCallback, useRef } from \"react\"\nimport { motion, useAnimationFrame } from \"motion/react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { useMousePositionRef } from \"@/hooks/use-mouse-position-ref\"\n\n/**\n * Interface for defining a single font variation axis.\n * Each axis represents a dimension of variation in a variable font. You should check the font variation settings of the font you are using to see the available axes.\n */\ninterface FontVariationAxis {\n  /**\n   * The name of the font variation axis (e.g., \"wght\" for weight, \"slnt\" for slant).\n   * This corresponds to the OpenType variation axis tags, but can be arbitrary. Make sure to check the font variation settings of the font you are using to see the available axes.\n   */\n  name: string\n\n  /**\n   * The minimum value for this axis.\n   * Applied when the cursor is at the left edge (for x-axis) or top edge (for y-axis).\n   */\n  min: number\n\n  /**\n   * The maximum value for this axis.\n   * Applied when the cursor is at the right edge (for x-axis) or bottom edge (for y-axis).\n   */\n  max: number\n}\n\n/**\n * Interface for mapping cursor position to font variation settings.\n * Allows independent control of two font variation axes based on cursor movement.\n */\ninterface FontVariationMapping {\n  /**\n   * Font variation axis controlled by horizontal cursor movement.\n   */\n  x: FontVariationAxis\n\n  /**\n   * Font variation axis controlled by vertical cursor movement.\n   */\n  y: FontVariationAxis\n}\n\n/**\n * Props for the VariableFontAndCursor component.\n */\ninterface TextProps extends React.HTMLAttributes<HTMLElement> {\n  /**\n   * The text content to display and animate.\n   * Required prop with no default value.\n   */\n  children: React.ReactNode\n\n  /**\n   * HTML Tag to render the component as.\n   * @default \"span\"\n   */\n  as?: ElementType\n\n  /**\n   * Mapping configuration that defines how cursor position affects font variation settings.\n   * Maps x and y cursor positions to specific font variation axes and value ranges.\n   * Required prop with no default value.\n   */\n  fontVariationMapping: FontVariationMapping\n\n  /**\n   * Reference to the container element for mouse tracking.\n   * The cursor position will be calculated relative to this container's bounds.\n   * Required prop with no default value.\n   */\n  containerRef: React.RefObject<HTMLDivElement>\n}\n\nconst VariableFontAndCursor = ({\n  children,\n  as = \"span\",\n  fontVariationMapping,\n  className,\n  containerRef,\n  ...props\n}: TextProps) => {\n  // Hook to track mouse position relative to the specified container\n  const mousePositionRef = useMousePositionRef(containerRef)\n\n  // Ref for the visible text span to apply font variation settings\n  const spanRef = useRef<HTMLSpanElement>(null)\n\n  /**\n   * Calculates font variation settings based on cursor position within the container.\n   *\n   * This function maps the cursor's x and y coordinates to font variation values\n   * by interpolating between the minimum and maximum values defined in the mapping.\n   * The position is normalized to a 0-1 range based on the container dimensions.\n   *\n   * @param xPosition - Horizontal cursor position relative to container\n   * @param yPosition - Vertical cursor position relative to container\n   * @returns CSS font-variation-settings string with calculated values\n   */\n  const interpolateFontVariationSettings = useCallback(\n    (xPosition: number, yPosition: number) => {\n      const container = containerRef.current\n      if (!container) return \"0 0\" // Return default values if container is null\n\n      // Get container dimensions for normalization\n      const containerWidth = container.clientWidth\n      const containerHeight = container.clientHeight\n\n      // Normalize cursor position to 0-1 range, clamped to container bounds\n      const xProgress = Math.min(Math.max(xPosition / containerWidth, 0), 1)\n      const yProgress = Math.min(Math.max(yPosition / containerHeight, 0), 1)\n\n      // Interpolate between min and max values for each axis\n      const xValue =\n        fontVariationMapping.x.min +\n        (fontVariationMapping.x.max - fontVariationMapping.x.min) * xProgress\n      const yValue =\n        fontVariationMapping.y.min +\n        (fontVariationMapping.y.max - fontVariationMapping.y.min) * yProgress\n\n      // Return CSS font-variation-settings string\n      return `'${fontVariationMapping.x.name}' ${xValue}, '${fontVariationMapping.y.name}' ${yValue}`\n    },\n    [fontVariationMapping, containerRef]\n  )\n\n  // Use animation frame to smoothly update font variations on every frame\n  // This ensures smooth transitions as the cursor moves\n  useAnimationFrame(() => {\n    const settings = interpolateFontVariationSettings(\n      mousePositionRef.current.x,\n      mousePositionRef.current.y\n    )\n    if (spanRef.current) {\n      spanRef.current.style.fontVariationSettings = settings\n    }\n  })\n\n  // Custom motion component to render as the specified HTML tag\n  const MotionComponent = motion.create(as)\n\n  return (\n    <MotionComponent\n      className={cn(className)}\n      data-text={children}\n      ref={spanRef}\n      {...props}\n    >\n      <span className=\"inline-block\">{children}</span>\n    </MotionComponent>\n  )\n}\n\nexport default VariableFontAndCursor\n",
      "type": "registry:ui",
      "target": "components/fancy/text/variable-font-and-cursor.tsx"
    }
  ]
}